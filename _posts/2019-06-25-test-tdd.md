---
layout: post
title: 테스트 주도 개발 (TDD)
categories: Programming
categories: TODO
---

TDD, '테스트 주도 개발'이라는 용어를 한번쯤은 들어 보았을 것입니다. 용어 그대로 테스트가 개발을 이끌어 나간다는 뜻 입니다. 보통은 소프트웨어 개발을 할 때 코딩을 다 끝나고 난 후 테스트를 합니다. 코딩이 끝난 후, 개발자가 코딩을 다 짜고 난 후 완성했다고 생각할 때 테스트가 이루어지는데 이것의 순서를 바꾸는 것이 TDD를 적용하는 것이라고 할 수 있습니다. 테스트 주도 개발은 테스트를 먼저 만들고 테스트를 통과하기 위한 것을 짜는 것입니다. 

## 테스트 주도 개발(TDD)

### 결정과 피드백 
테스트 코드를 만드는 과정에서 우선 테스트를 작성하고 그걸 통과하는 코드를 만들고를 반복하면서 제대로 동작하는지에 대한 피드백을 적극적으로 받게 됩니다. `결정과 피드백 사이의 갭을 인식`해야 합니다. 여기서 결정과 피드백이란 다음을 뜻합니다.

- 결정(decision): 프로그램을 하다보면 '이 방법으로 해야지', '이 부분은 이걸 이용해서 짜야지'라는 것을 결정한다.
- 피드백(feedback): 프로그램을 하다보면 성공/실패(에러)라는 피드백을 받는다.

이때, 이 둘(결정과 피드백) 사이에 갭이 생기게 됩니다. 갭이 커질수록 문제이고, 그 갭을 모르면 더 큰 문제가 됩니다. 이 둘 사이의 갭을 개발시에 인식하고 있다면 테스트 주도 개발, 즉 TDD를 하고 있는 것입니다.


### TDD를 적용한 사례
#### 개발 해야 하는 것
생년월일(input)을 입력받으면 현재 나이(output)를 출력하는 프로그램

#### 목표 정하기
태어난 해와 올해의 연도를 입력하여 현재 나이를 입력받는다. 
- ex) 2015, 2018 -> (만)3살 우선 이것을 만들겠다는 생각을 한다.

#### 무엇을 테스트 할지 설계
만들기도 전에 만든 후에 무엇을 테스트할지를 설계한다. 
- ex) 2015, 2018를 입력하면 2가 나오는 테스트 코드를 만든다. 그리고 프로그램(코드)를 만든다.

#### 테스트 수행
테스트 프로그램으로 이 프로그램을 실행한다. 통과했으면 새로운 테스트를 추가한다.


## TDD를 왜 해야할까
애자일이란에서 설명한 것과 같이 불확실성이 높을 때 '피드백'과 '협력이 중요합니다.피드백과 협력이 중요한 이유는 불확실성이 높을 때 '피드백'과 '협력'을 이용하면 더 좋은 결과가 나올 확률이 높아지기 때문입니다. TDD도 마찬가지로 '피드백'과 '협력'을 증진시키는 것이기 때문에 불확실성이 높을 때 도움이 될 수 있습니다.

## TDD는 언제, 어떻게 사용하면 좋을까
만약 어떤 부분에 대한 코딩을 여러번 해봤고 결과가 어떻게 나올지 뻔하다면 TDD를 하지 않아도 됩니다. 또한 TDD를 했을 때 얻는 것이 적다면 TDD를 하지 않아도 됩니다. 그렇다면 TDD는 어떤 상황에서 해야할까요? 바로 다음과 같은 경우 일 것입니다.

- 처음해보는 프로그램 주제
- 나에 대한 불확실성이 높은 경우
- 고객의 요구조건이 바뀔 수 있는 프로젝트
- 외부적인 불확실성이 높은 경우
- 개발하는 중에 코드를 많이 바꿔야 된다고 생각하는 경우
- 내가 개발하고 나서 이 코드를 누가 유지보수할지 모르는 경우

즉, 불확실성이 높을 때 TDD를 하면 됩니다.

## TDD의 효과

## 피드백
TDD를 하면 피드백이 증가합니다. 테스트를 통과하는 것으로 잘되고 있는가를 자주 확인할 수 있습니다. 이 부분은 사람들이 쉽게 느낄 수 있다.

## 협력
이 부분이 핵심!이라고 할 수 있습니다. 'test'는 일반적으로 동사로 사용합니다. '테스트한다.', '테스트해라.' 그러나 TDD를 하면 'test'는 명사가 됩니다. 'test'가 명사가 된다는 것은 동사로서의 test와 차이가 있는데, 동사는 그 순간에만 하는 것이고, 명사(대상, 목적어)는 이후에도 소유할 수가 있게 됩니다. 즉, record로 남을 수 있습니다. 'test'가 저장된다는 것은 남들에게 남들에게 테스트 코드를 보여줄 수 있고, 남들은 그 코드를 직접 실행해볼 수 있다는 것입니다. 따라서 'test'가 명사(대상, 목적어)가 되는 순간 이것을 공유하기가 쉬워지고 공유하면 협력이 증진된다고 할 수 있습니다. 

- 남이 짠 코드를 빨리 이해할 수 있다.
- 남이 짠 코드를 쉽게 이해할 수 있다.
- 용기가 생긴다.(내가 남의 코드를 고쳐서 문제가 있더라도 자동화된 테스트가 알려주기 때문에 큰 걱정없이 고칠 수 있는 용기가 생긴다.)
- 내가 이 코드를 고쳤을 때 이것을 망치면 어떡하지..
- 내가 그 사람의 의도를 모르는데 이것을 고쳐도 될까..

즉, 왜 이렇게 짰을까 궁금할 때 'test'를 공유하고 그 테스트 코드를 보면 이해할 수 있습니다. 테스트 코드에는 개발자의 개발 과정(어떤 고민/어떤 의사결정)이 나와있기 때문입니다.

정리하면 TDD의 정의(결정(decision)과 피드백(feedback) 사이의 갭을 인식하는 것)와 같이 테스트 코드(feedback)를 보면 그 사람의 의사결정(decision)이 나타나고 상대방은 그 부분은 왜 그렇게 짰는지를 쉽고 빨리 알게 되기 때문에 협력이 증진됩니다.


## TDD의 장단점
TDD를 하면 테스트를 주도로 개발을 하기 때문에, 오로지 개발만 했을때 보다는 개발속도가 느려진다고 생각하는 사람이 많기 때문에 사람들은 TDD에 대해 반신반의 합니다. 처음부터 2개의 코드를 짜야하고 중간중간 테스트를 하면서 고쳐나가야하기 때문입니다.

### 단점
TDD를 하면 개발 시간이 늘어납니다. 개발 시간이 TDD를 하지않을 때에 비해 대략 10~30%가 늘어나게 됩니다. 

### 장점
피드백과 협력을 증진시키기 때문에 불확실성에 대해 대비를 할 수 있는 장점이 있습니다. TDD를 하면 결함이 대략 1/2~1/10 까지 줄어듭니다. 특히 SW를 개발하면서 예상하지 못했던 시간을 많이 소요하는 것은 대부분이 버그 때문인데, 이러한 결함이 줄어 들게 되는 것입니다.

- TDD를 하면 이런 버그를 줄일 수 있다.
- TDD를 하면 코드 복잡도가 떨어진다.
- 엔트로피(Entropie)가 낮아진다.
- 깨끗한 코드가 나온다.
- 유지보수 비용이 낮아진다.

참고） 엔트로피: 정보에 포함되어 있는 불확실성의 정도.

#### 복잡도에 대한 재미있는 연구
- 복잡도에 대해 수치로 계산할 수 있다.
- 들여쓰기(Indent)가 많은 코드는 복잡한 코드이다.
- 복잡성 지표(Cyclomatic Complexity)를 통해 들여쓰기에 따라 복잡도를 숫자로 계산한다.
- 계산한 복잡도가 일정 수치 이상이 넘어가면 버그를 고칠 때 나도 모르게 버그를 삽입할 확률이 1에 수렴한다.

즉, 내가 버그 하나를 고치려고 그 코드를 고쳤는데 나도 모르게 새로운 버그를 넣는 확률이 1에 수렴한다는 것입니다. 복잡도가 높으면 버그 숫자가 줄지 않습니다.



## 정리
소프트웨어 테스트란 다음과 같이 정의 될 수 있습니다. 

- 노출되지 않은 숨어있는 결함(Fault)을 찾기 위해 소프트웨어를 작동시키는 일련의 행위와 절차
- 오류 발견을 목적으로 프로그램을 실행하여 품질을 평가하는 과정 
- 개발된 소프트웨어의 결함과 문제를 식별하고 품질을 평가하며 품질을 개선하기 위한 일련의 활동 
- 일반적으로 테스트 케이스에 따라 SW를 동적으로 실행시켜 예상결과치와 비교 분석 
- SW의 동작과 성능, 안정성이 요구되는 수준을 만족하는지 확인하기 위한 결함을 발견하는 메커니즘 
- 테스트는 프로그램이나 시스템이 예상대로 작동할 것이라는 확신을 증진시키는 과정 (Hetzel 1973)













TDD를 활용하기 어려운 이유와 잘 하는 방법
프로그래머 외의 사람들에게는 TDD는 어떤 의미가 있을까


https://gmlwjd9405.github.io/2018/06/03/agile-tdd.html


https://medium.com/@han7096/%ED%85%8C%EC%8A%A4%ED%8A%B8-%EC%A3%BC%EB%8F%84-%EA%B0%9C%EB%B0%9C-%EC%A0%80%EC%9E%90-%EC%BC%84%ED%8A%B8-%EB%B2%A1-%EC%B1%85-%EB%8F%85%ED%9B%84%EA%B0%90-69b3066440f


----
해당 내용은 다음 글을 참고 하였습니다.
- https://gmlwjd9405.github.io/2018/06/03/agile-tdd.html
