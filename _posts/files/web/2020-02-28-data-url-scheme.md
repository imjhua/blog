---
layout: post
title: Data URIs(Data URI scheme)
categories: Web
---

데이터 URI 스킴(data URI scheme)은 이미지와 같은 외부 데이터를 URI로 표현하는 방법입니다. 데이터 URI 스킴은 RFC 2397에 정의되어 있습니다.

## Data URIs(Data URI scheme)

Data URIs(Data URI scheme)란 `data:` 스킴이 접두어로 붙은 URI입니다. 작은 파일을 문서 내에 인라인으로 임베드하기 위한 URI 스킴입니다. 주로 아이콘 등의 작은 이미지 파일에 사용됩니다. 데이터 URI는 이미지 뿐만 아니라 동영상, 플래시와 같은 데이터들도 표현할 수 있고 HTML이나 TXT 파일도 표현할 수 있습니다. iframe의 src도 데이터 URI로 표현이 가능합니다. window.open()으로 팝업을 열 때에도 별도의 파일 없이 팝업을 사용할 수 있습니다.

보통 HTML에서 이미지를 표현할 때에는 img 요소의 src 속성의 값으로 이미지의 경로를 입력하지만 데이터 URI 스킴을 사용하면 src 속성의 값으로 base-64로 인코딩된 이미지 데이터를 직접 입력할 수 있습니다. base-64로 변경하는 방법은 거의 대부분의 언어에서 지원하고 있고 Data URI Converter 처럼 웹에서 간편하게 사용할 수 있는 서비스들도 많습니다.

## 문법

```
data:[<mediatype>][;base64],<data>
```

- mediatype : MIME 타입. 생략된시, 기본 값 text/plain;charset=US-ASCII
- base64 : 데이터가 텍스트가 아닌 경우 base64 인코딩된 데이터가 필요하다.

참고) base64인코딩은 바이너리 데이터를 안전하게 전송할 수 있게 하는 인코딩. HTML 또는 Email과 같이 문자를 위한 Media에 Binary Data를 포함해야 될 필요가 있을 때, 포함된 Binary Data가 시스템 독립적으로 동일하게 전송 또는 저장되는걸 보장하기 위해 사용하고 이때 Base64는 ASCII 중 제어문자와 일부 특수문자를 제외한 64개의 안전한 출력 문자만 사용한다.

## 예

보통 HTML에서 이미지를 표현할 때에는 img 요소의 src 속성의 값으로 이미지의 경로를 입력하지만 데이타 URI 스킴을 사용하면 src 속성의 값으로 base-64로 인코딩된 이미지 데이터를 직접 입력할 수 있습니다.
HTML 파일에 넣거나 src의 값을 브라우저의 주소창에 입력해보면 이미지 파일 없이 이미지가 표현되는 것을 확인할 수 있습니다. 이렇게 하면 이미지와 같은 외부 데이터를 별도의 파일로 두지 않고 하나의 HTML 파일로 관리할 수 있습니다. 파일이 하나이다보니 HTTP 헤더정보나 TCP 패킷 크기가 맞지 않아서 발생하는 오버헤드가 발생하지 않습니다. 결과적으로 리퀘스트 수를 줄여서 빠른 전송효과를 볼 수 있습니다. 단점도 많습니다. HTML 파일에 포함되다보니 캐시가 되지 않습니다. 그리고 데이터가 base-64로 인코딩되면서 크기가 1/3 정도 증가하게됩니다. HTTP 헤더에서 이득을 볼 수 있다고 하더라도 600바이트가 넘어가는 이미지는 용량면에서 손해입니다.

```html
<img src="data:image/png;base64, iVBORw0KGgoAAAANSUhE~~" />
```

## 특징

- 소스 코드 내 삽입이 가능하다
- 추가적인 HTTP 요청이 일어나지 않는다.
- 캐싱 되지 않는다.
- 용량: base64 포맷으로 인코딩하면 원본 파일보다 더 용량이 커진다.
- 긴 문자열: 브라우저에 따라 문자 길이에 제한이 있기 때문에, 용량이 큰 이미지 등은 처리하지 못할 수 있다.
- 소스코드 상에 삽입하면 소스 가독성이 떨어질 수 있다.

## 장점

위의 코드를 HTML 파일에 넣거나 src의 값을 브라우저의 주소창에 입력해보면 이미지 파일 없이 이미지가 표현되는 것을 확인할 수 있습니다. 이렇게 하면 이미지와 같은 외부 데이터를 별도의 파일로 두지 않고 하나의 HTML 파일로 관리할 수 있습니다. 파일이 하나이다보니 HTTP 헤더정보나 TCP 패킷 크기가 맞지 않아서 발생하는 오버헤드가 발생하지 않습니다. 결과적으로 리퀘스트 수를 줄여서 빠른 전송효과를 볼 수 있습니다.

## 단점

HTML 파일에 포함되다보니 캐시가 되지 않습니다. 그리고 데이터가 base-64로 인코딩되면서 크기가 1/3 정도 증가하게됩니다. HTTP 헤더에서 이득을 볼 수 있다고 하더라도 600바이트가 넘어가는 이미지는 용량면에서 손해입니다. 그리고 대부분의 브라우저가 현재 데이터 URI를 지원하지만 IE7 이하버전은 지원하지 않습니다. 또한 IE8도 32KiB 이상의 데이터는 지원하지 않고 몇몇 제약이 있습니다.

## 결론

장단점을 종합해보면 사용할 수 있는 환경이 아주 많지는 않지만 경우에 따라서는 아주 유용할 수도 있는 기술 입니다. IE에서 지원이 안되기 때문에 일반적인 웹페이지에서는 사용하기가 힘들지만 특정환경에서 사용하는 웹페이지들이나 사용자 브라우저를 어느정도 제한할 수 있는 상황에서는 유용할 것 입니다. 이메일같이 별도의 이미지 서버가 필요한 경우도 이 데이터 URI를 사용하면 서버가 필요 없습니다. 다만 이메일 클라이언트가 매우 다양하기 때문에 이미지가 나오지 않을 수도 있다는 것을 유념해야 합니다. 특히나 작은 아이콘이 아주 많을 경우에 아주 유용하게 사용할 수 있습니다.

---

해당 내용은 다음 글을 참고 하였습니다.

- https://d0gf00t.tistory.com/15
- https://hyeonseok.com/soojung/webstandards/2011/02/17/641.html
- https://developer.mozilla.org/ko/docs/Web/HTTP/Basics_of_HTTP/Data_URIs
