---
layout: post
title: 세션(Session) vs 쿠키(Cookie) vs 웹 스토리지(Web Storage)
categories: Web
---

웹 사이트의 정보를 저장하기 위해 반드시 서버를 사용하는 것만은 아닙니다. 클라이언트의 저장공간도 충분히 좋은 저장소로서 역할을 할 수 있으며 가장 손쉽게 쿠키를 떠올릴 수 있습니다. 하지만 html5에는 좀 더 효과적인 클라이언트 저장공간을 제공하는데 이는 쿠키가 아닌 다른 방법으로의 새로운 API입니다. 로컬 저장소를 웹에서 사용할 경우 가장 많이 사용되는 방법은 쿠키와 로컬 스토리지가 있습니다. 이 둘은 다 다른 목적을 가지고 있기 때문에 무엇이 옳다고 할 수 없으며 목적에 따라 알맞게 사용해야 합니다. 이 둘의 목적과 사용시의 장단점, 그리고 명확한 차이에 대해 알아 봅시다.

## Session

세션이란 클라이언트(웹 브라우저)의 정보를 서버에서 저장하는 객체를 말합니다. 브라우저마다 별도의 세션을 가집니다. 로그인 정보처럼 페이지를 이동하더라도 계속 유지되어야 하는 정보를 저장합니다. 일정 시간동안 같은 브라우저로 부터 들어오는 일련의 요구를 하나의 상태로 보고 그 상태를 유지하는 기술 즉, 웹 브라우저를 통해 웹 서버에 접속한 이후로 브라우저를 종료할 때 까지 유지되는 상태를 뜻 합니다. 클라이언트가 Request를 보내면, 해당 서버의 엔진이 클라이언트에게 유일한 ID를 부여하는 데 이것이 세션ID입니다. 이를 통해 로그인 정보를 유지 할 수 있습니다.

세션은 서버의 자원을 사용하기 때문에 무분별하게 만들다보면 서버의 메모리가 감당할 수 없어질 수가 있고 정보가 서버에 있기 때문에 처리가 요구되어 속도가 느려질 수 있기 때문에 세션을 주로 사용하는데는 부담스럽습니다. 쿠키를 이용해서 sessionid만 저장하고 그것으로 구분하여 서버에서 처리하기 때문에 비교적 보안성이 좋습니다.

라이프사이클: 만료시간을 정할 수 있디만 브라우저가 종료되는 만료시간에 상관없이 삭제됩니다.

- 클라이언트 정보를 서버에 저장.
- 로그인 정보처럼 페이지를 이동하더라도 계속 유지되어야 하는 정보를 저장한다.
- 브라우저마다 별도 세션 가진다.
- 브라우저 종료할때까지 유지된다.
- 세션아이디를 주고 받기도 한다.
- 단점은, 서버의 메모리를 사용하는 것이기 때문에 서버자원 문제 및 서버에 있는 정보 처리가 요구되어 속도가 느려질 수 있다.
- 세션아이디만 쿠키에 저장해서 사용하면 비교적 보안에 좋다.

## Cookie

클라이언트의 저장소로서 서버와 클라이언트 간의 지속적인 데이터 교환 목적으로 사용됩니다. 사용자의 브라우저에 파일의 형태로 데이터를 저장하고 그 데이터를 서버가 사용합니다. 쿠키가 만들어지면 서버를 요청할 때 마다 같이 전송되는데 문자열만 저장 가능하고 만료일 설정이 가능하며 저장 용량이 4096bytes로 제한적이기 때문에 간단한 텍스트를 저장하고 가져오는데 사용합니다. 따라서 서버에서의 사용이 필수적이고 잦다면 쿠키를 사용하여 클라이언트와 서버의 인터렉션을 효과적으로 사용할 수 있습니다. 클라이언트 로컬에 저장되기 때문에 변질되거나 요청에서 스나이핑 당할 우려가 있어 보안에는 취약합니다. 주의할 점으로는 서버통신에 필요하지 않은 정보는 저장하지 않는 것이 좋은데 이유는 서버 통신에 필요없는 데이터를 전송하게 되면 데이터 낭비가 되기 때문입니다.

라이프사이클: 만료시간이 있지만 파일로 저장되기 때문에 브라우저를 종료해도 계속해서 정보가 남아 있을 수 있습니다. 또한 만료기간을 넉넉하게 잡아두면 쿠키삭제를 할때까지 유지될 수도 있습니다.

- 서버와 클라이언트 간의 지속적인 데이터 교환 목적으로 사용한다.
- 브라우저에 파일 형태로 저장한다.
- 파일로 저장되기 때문에 브라우저 종료해도 정보는 남아 있다
- 서버 요청시마다 함께 전송되며 문자열만 저장 가능하다. (4KB)
- 서버통신에 필요없는 데이터를 전송하게되면 데이터가 낭비된다.
- 팝업창 일정기간 보이지 않기, 서버통신에 필요한 인증과 관련된 정보나 세션에 저장된 토큰값을 저장하는데 활용된다.

### 활용

- 팝업창을 일정기간 동안 보이지 않도록 하기
- 서버 통신에 필요한 인증과 관련된 정보
- 세션에 저장된 토큰 값 (보안에 필요한 정보를 저장)

### 제한점

- 4KB의 데이터 저장 제한
- 쿠키는 매 HTTP 요청에 포함되어 있어 웹이 느려지게 하는 원인이 될 수 있음
- 같은 도메인 내의 모든 페이지에 같이 전달 됨
- HTTP 요청에 암호화 되지 않고 보내기 때문에 보안에 취약함
- 사용자의 로컬에 텍스트로 저장 되어있어 쉽게 접근가능 (내용 확인이 가능함)

## Web Storage

쿠키의 제한점을 보완하기 위하여 html5에서 등장하였습니다. 용량을 확장하고 서버로는 전달이 되지 않아 브라우저 로컬에만 저장되며 보안도 보장할 수 있도록 새로운 표준을 정의한 것이 바로 웹 스토리지입니다. 대부분의 브라우저는 스토리지를 지원해주고 있으나 100%는 아직 아닙니다. 브라우저에 데이터를 저장할 수 있는 HTML5 API이기 때문에 지원되지 않는 브라우저에서는 동작하지 않습니다. 웹 스토리지는 서버가 읽지 않으며 localStorage, sessionStorage 2가지가 있습니다. 두 스토리지 모두 window 객체 안에 들어 있으며 Storage 객체를 상속 받기 때문에 메소드가 공통적으로 존재하며 자바스크립트 객체(문자열, 숫자 등) 모두 저장이 가능합니다.

- 쿠키의 제한점을 보완하기 위하여 등장하였다.
- 용량도 커졌고 서버로는 전달되지 않고 브라우저 로컬에만 저장되어 보안이 보장된다.
- 윈도우객체안에 들어있다.
- 자바스크립트 객체저장이 가능하다.

### 활용

- 이전에 보았던 상품 목록 (히스토리 저장)
- 팝업창을 일정기간 동안 보이지 않도록 하기
- 로컬 임시 저장 (페이지에서 벗어난 경우 백업/복구)

### localStorage

삭제하기 전 까지 브라우저에 계속 저장 되어 있으며 용량은 약 10MB 입니다.

### sessionStorage

세션 유지기간에만 사용가능한 스토리지로 브라우저를 종료하면 자동 소멸하고 용량은 약 5MB 입니다.

## 정리

세션과 쿠키

| 기능         | 세션            | 쿠키                     |
| ------------ | --------------- | ------------------------ |
| 저장 위치    | 서버            | 클라이언트에 파일로 저장 |
| 보안         | 좋다            | 취약                     |
| 라이프사이클 | 브라우저 종료시 | 만료시간                 |
| 속도         | 비교적 느림     | 빠르다                   |

쿠키와 웹 스토리지

| 속성     | 쿠키        | local storage | session storage   |
| :------- | :---------- | :------------ | :---------------- |
| 용량     | 4KB         | 10MB          | 5MB               |
| 브라우저 | html4/html5 | html5         | html5             |
| 접근성   | 모든 윈도우 | 모든 윈도우   | 같은 탭           |
| 유효     | 직접 지정   | 영구          | 탭이 닫힐 때 까지 |

## 결론

쿠키는 저장 용량이 작기 때문에 간단한 텍스트를 저장하고 가져오는데 사용됩니다. 또한 서버에서의 사용이 필수적이고 잦다면 쿠키를 사용하여 클라이언트와 서버의 인터렉션을 효과적으로 사용할 수 있습니다. 만료일을 설정하기 때문에 일정 시간이 지나면 저장된 데이터를 사용할 수 없게 되므로 보안이나 내부 데이터 관련 내용들은 쿠키 사용이 더 적합 할 수 있습니다.

디바이스 및 브라우저 호환성을 고려한다면 모든 100% 브라우저가 HTML5 API를 지원하고 있는 것이 아니기 때문에 쿠키의 사용이 더 나을 수 있습니다.

반대로 로컬 스토리지의 경우 사용자가 임의로 삭제하지 않는 경우 삭제되지 않기 때문에 중요한 내용 보다는 단순 보관 용도로 사용할 때 더 적합합니다. 저장소의 크기가 크기 때문에 저장할 내용이 많은 경우 쿠키보다 로컬 저장소를 사용아는 것이 효과적입니다.
