---
layout: post
title: 실행컨텍스트
categories: JavaScript
categories: TODO
---

## 실행컨텍스트(EC: Execution Context)

실행 컨텍스트는 실행 가능한 코드를 형상화하고 구분하는 추상적인 개념이지만 물리적으로는 객체의 형태를 갖는다. 전역EC와 함수별EC를 가질수 있다. 3가지 프로퍼티를 가진다.

1. Variable Object (VO / 변수객체)
2. Scope Chain (SC)
3. this value

### 변수객체(VO: Variable Object)

VO는 아래의 정보를 담는 객체이다.

- 변수
- 매개변수(parameter)와 인수정보(arguments)
- 함수 선언(함수 표현식은 제외)

Variable Object는 실행 컨텍스트의 프로퍼티이기 때문에 값을 가지고 이 값은 다른 객체(전역GO/함수AO)를 가킨다. 전역컨텍스트, 함수컨텍스트의 경우, 가리키는 객체가 다르다. 이유는 각각의 내용이 다르기 때문이다. 예로 전역 코드에는 매개변수가 없지만 함수에는 매개변수가 있다.

- 전역객체 GO: 유일하며 최상위에 위치하고 모든 전역 변수, 전역 함수 등을 포함하는 전역 객체(Global Object / GO)를 가리킨다. 전역 객체는 전역에 선언된 전역 변수와 전역 함수를 프로퍼티로 소유한다.
- 활성객체 AO: 매개변수와 인수들의 정보를 배열의 형태로 담고 있는 객체인 arguments object가 추가

### 스코프 체인(SC: Scope Chain)

스코프 체인(Scope Chain)은 일종의 리스트로서 전역 객체와 중첩된 함수 스코프의 레퍼런스를 차례로 저장하고 있다. 다시 말해, 스코프 체인은 해당 전역 또는 함수가 참조할 수 있는 변수, 함수 선언 등의 정보를 담고 있는 전역 객체(GO) 또는 활성 객체(AO)의 리스트를 가리킨다.

- 스코프 체인은 식별자 중에서 객체(전역 객체 제외)의 프로퍼티가 아닌 식별자, 즉 변수를 검색하는 메커니즘이다. 식별자 중에서 변수가 아닌 객체의 프로퍼티(물론 메소드도 포함된다)를 검색하는 메커니즘은 프로토타입 체인(Prototype Chain)이다.

### this value

this 프로퍼티에는 this 값이 할당된다. this에 할당되는 값은 함수 호출 패턴에 의해 결정된다.

- 메소드 호출 패턴
- 함수 호출 패턴
- 생성자 호출 패턴
- call / apply 호출 패턴

## 클로저

클로저는, `함수 자신이 포함하는 스코프의 변수들!을 추적하는 함수`입니다. 함수가 중첩되어 있으면 중첩될 때마다 부모 함수의 Scope가 자식 함수의 스코프 체인(스코프 프로퍼티)에 포함됩니다.

- 자바스크립트 함수는, 호출되었을 때 실행되기 위한 코드뿐만 아니라, 더 많은 정보를 포함하고 있기 때문에 만들어진 환경을 기억한다고 할 수 있습니다. (이때, 메모리 소모)
- 자바스크립트 함수는, 해당 스코프에 선언되어 어떤 변수더라도, 내부적으로 보관합니다.
- 따라서 스코프 내에 포함된 어떤 변수라도 참조할 수 있고
- 값을 복사하지 않고 참조하고 있기 때문에 외부변수의 값을 변경 할 수도 있습니다.
- 클로저를 통해 내부 변수를 참조하는 동안에는 해당 변수가 차지하는 메모리를 GC가 회수하지 않으므로 클로저 사용이 끝나면 참조를 제거하는 것이 좋습니다.
- 클로저는 함수내의 지역변수를 감추는 은폐의 역할을 가능하게 합니다.
- 복잡한 코드를 쉽고 간결한 코드를 작성할 수 있습니다. (객체반환x, 함수반환o)
- 자바스크립트에서 클로저가 많이 사용되는 부분은 이벤트 그리고 비동기식 호출의 경우라고 할 수 있습니다.

```js
function makeSizer(size) {
  return function() {
    document.body.style.fontSize = size + "px";
  };
}

var size12 = makeSizer(12);
var size14 = makeSizer(14);
var size16 = makeSizer(16);

document.getElementById("size-12").onclick = size12;
document.getElementById("size-14").onclick = size14;
document.getElementById("size-16").onclick = size16;
```

- 클로저 스코프 메커니즘: 내부 함수의 [[Scopes]] 프로퍼티는 자신의 실행 환경(Lexical Enviroment)과 자신을 포함하는 외부 함수의 실행 환경과 전역 객체를 가리키는데 이때 자신을 포함하는 외부 함수의 실행 컨텍스트가 소멸하여도 [[Scopes]] 프로퍼티가 가리키는 외부 함수의 실행 환경(Activation object)은 소멸하지 않고 참조할 수 있다. 이것이 클로저이다.

* 스코프체인: 변수검색 메커니즘
* 프로토타입체인: 객체의 프로퍼티를 검색하는 메커니즘


----
해당 내용은 다음 글을 참고 하였습니다.
- 