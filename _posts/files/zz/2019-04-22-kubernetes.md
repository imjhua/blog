---
layout: post
title: 쿠버네티스(Kubernetes) 
categories: Cloud
categories: TODO
---

마이크로 서비스 아키텍처가 단순 개념에서부터 점점 더 발전하기 시작했습니다. 디자인 패턴과 이를 구현하기 위한 다양한 인프라 플랫폼들이 소개 되고 있습니다. 서비스가 점점 작아지면서 1~2코어로도 운영할 수 있는 작언 서비스들이 등장하면서 이런 작은 서비스들이 VM환경으로 운영되기에는 낭비가 존재하게 되었습니다. 왜냐하면 VM이미지 크기도 크고 다양한 이미지를 VM으로 관리 배포 하기에는 배포 속도 등 다양한 문제들이 발생하기 때문입니다. 

## 배경
데브옵스 개념도 나온지는 오래되었지만 정리되는 내용으로는, 개발팀이 개발과 시스템에 대한 배포/운영을 담당한다면, 데브옵스팀은 개발팀이 이를 쉽게할 수 있는 아랫단의 플랫폼과 자동화를 하는데 목표를 두는 역할로 역힐이 명확해지고 있습니다. 이러한 배경에서 컨테이너기반의 호나경이 실질적으로 적용되면서 컨테이너환경을 관리하는 툴들이 등장하였고 쿠버네티스는 그중 대표되는 도구 입니다.

컨테이너환경을 관리하는 도구들은 많이 존재 합니다. 쿠버네티스 이외에도 Swarm, Mesosphere등이 있는데 왜 쿠버네티스를 배워야 할까요? 컨테이너 운용 환경은 여러 오픈소스에 의해서 표준이 없이 혼돈이었다가 작년말을 기점으로 해서 쿠버네티스가 de-facto 표준으로 되어가고 있습니다. 쿠버네티스에 대해 자세히 알아 봅시다.

## 쿠버네티스(Kubernetes, 약어로 k8s)
쿠버네티스는 컨테이너화된 워크로드와 서비스를 관리하기 위한 이식성이 있고, 확장가능한 오픈소스 플랫폼입니다. 쿠버네티스는 선언적 구성과 자동화를 모두 용이하게 해줍니다. 크고, 빠르게 성장하는 생태계를 가지고 있으며 서비스, 기술 지원 및 도구는 어디서나 쉽게 이용할 수 있습니다. 구글이 2014년에 쿠버네티스 프로젝트를 오픈소스화한 것을 시작으로 쿠버네티스는 구글의 15여년에 걸친 대규모 운영 워크로드 운영 경험을 기반으로 만들어졌으며 커뮤니티의 최고의 아이디어와 적용 사례가 결합되었는 도구 입니다.

주요 클라우드 벤더인 아마존, 구글, 애저 모두 컨테이너 관리 환경을 쿠버네티스를 지원하는 정책으로 변화된것은 물론이고 IBM이나 시스코와 같은 온프렘(on-premise) 솔루션 업체들도 경쟁적으로 쿠버네티스를 지원하고 있습니다. 

쿠버네티스는 GO 언어로 구현이되었으며, 특히 재미있는 것은 벤더나 플랫폼에 종속되지 않기 때문에, 대부분의 퍼블릭 클라우드(구글, 아마존, 애저)등에 사용이 가능하고 오픈 스택과 같은 프라이빗 클라우드 구축 환경이나 또는 베어메탈(가상화 환경을 사용하지 않는 일반 서버 하드웨어)에도 배포가 가능합니다. 이런 이유 때문에 여러 퍼블릭 클라우드를 섞어서 사용하는 환경이나 온프렘/퍼블릭 클라우드를 혼용해서 쓰는 환경에도 동일하게 적용이 가능하기 때문에 하이브리드 클라우드 솔루션으로 많이 각광 받고 있습니다.


### 컨테이너
흔히들 컨테이너를 이야기 하면 도커를 떠올리기 쉬운데, 도커가 물론 컨테이너 엔진의 대표격이기는 하지만 이 이외도 rkt나 Hyper container(https://hypercontainer.io/) 등 다양한 컨테이너 엔진들이 있으며, 쿠버네티스는 이런 다양한 컨테이너 엔진을 지원합니다. 

### 컨테이너 운영환경
쿠버네티스가 제공하는 컨테이너 운영환경이란 무엇일까요? 이를 이해하기 위해서는 먼저 컨테이너에 대해서 이해할 필요가 있습니다. 컨테이너의 가장 대표적인 예로는 도커가 있습니다. 작은 수의 컨테이너라면 수동으로 VM이나 하드웨어에 직접 배포하면 되지만, VM이나 하드웨어의 수가 많아지고 컨테이너의 수가 많아지면, 이 컨테이너를 어디에 배포해야 하는지에 대한 결정이 필요합니다. 자원을 최대한 최적으로 사용하기 위해서 적절한 위치에 배포해야 하고, 애플리케이션 특성에 따라서 같은 물리 서버에 배포가 되어야 하거나 또는 가용성을 위해 일부러 다른 물리서버에 배포되어야 하는 일이 있습니다. 이렇게 컨테이너를 적절한 서버에 배포해주는 역할을 스케쥴링이라고 합니다. 이러한 스케쥴링 뿐만이 아니라 컨테이너가 정상적으로 작동하고 있는지 체크하고 문제가 있으면 재 기동등을 해주고, 모니터링, 삭제관리등 컨테이너에 대한 종합적인 관리가 필요한데 이러한 환경을 컨테이너 운영환경이라고 합니다. 단순하게 도커 컨테이너를 하드웨어나 VM에 배포하고 사용하는 것이상으로 컨테이너 운영환경에 대한 해결안이 필요하게 된 것입니다.


### 컨테이너와 VM
컨테이너 환경을 왜 VM에 올릴까요? 온프렘 환경(데이타센터)에서 쿠버네티스를 올릴때 궁금했던점 중의 하나가, 바로 베어메탈 머신위에 쿠버네티스를 깔면 되는데, 보통 배포 구조는 VM(가상화 환경)을 올린 후에, 그 위에 쿠버네티스를 배포하는 구조를 갖는다는 점입니다. 이것은 하드웨어의 자원 활용의 효율성이 높이지 위함입니다. 컨테이너 환경은 말그대로 하드웨어 자원을 컨테이너화하여 isolation 하는 기능이 주다. 그에 반해 가상화 환경은 isolation 기능도 가지고 있지만, 가상화를 통해서 자원하며 특히 CPU의 수를 늘릴 수 있습니다. 따라서 가상화 하여 좀 더 자원을 잘게 나눠서 사용이 가능하기 때문에 컨테이너를 VM에 올려 사용합니다.  이 이외에도 스토리지 자원의 활용 용이성이나 노드 확장등을 유연하게 할 수 있는 장점이 있습니다.


## 쿠버네티스를 구성하는 컴포넌트들

## 의 구성과 개념


----
해당 내용은 다음 글을 참고 하였습니다.
- https://bcho.tistory.com/1255