---
layout: post
title: Base64 인코딩
categories: Web
---

인코딩(encoding)이란 정보의 형태나 형식을 여러가지 목적에 따라 (저장 공간, 데이터 표준화, 보안, 퍼포먼스, 등)을 위해서 다른 형태나 형식으로 변환하는 처리 혹은 그 처리 방식을 뜻하는 개념입니다. Base64는 Binary Data를 텍스트로 변경하는 인코딩 방식중 하나로 바이너리 데이터를 문자 코드에 영향을 받지 않는 공통 64개의 ASCII 영역의 문자들로 이루어진 문자열로 변경합니다. Base 64를 글자 그대로 번역하여 보면 64진법이란 뜻을 가집니다. 64진법은 컴퓨터한테 특별한데 그 이유는 64가 2의 제곱수 64=2^6이며 2의 제곱수에 기반한 진법 중 화면에 표시되는 ASCII 문자들로 표시할 수 있는 가장 큰 진법이기 때문입니다. (ASCII에는 제어문자가 다수 포함되어 있기 때문에 화면에 표시되는 ASCII 문자는 128개가 되지 않는다.) 


## Base64 Encoding
Base64 Encoding은 Binary Data를 Text로 변경하는 Encoding입니다. Base64의 목적은 모든 가능한 바이트값(ex-이미지)을 신뢰할 수없는 통신 채널을 통해 바이너리 데이터를 안전하게 전송할 수 있게 하는 것입니다. 최초에는 이진 데이터를 다목적 인터넷 메일 확장의 일부로 전자 메일에 첨부 할 수있는 방법으로 고안되었습니다. 과거에는 서로 다른 응용 프로그램마다 각각 다른 요구 사항이 있었기 때문에 조금씩 다른 방식으로 기본 인코딩이 구현되는 경우가 많았는데 ASCII 유형의 데이터를 바로 전송받아 처리하는 것은 프로토콜, 시스템마다 다르게 해석되어 데이터가 왜곡될 여지가 있기 때문에 적합하지 않았습니다. 그리고 이기종 시스템간 이진 데이터를 전송할때 문자셋과 상관없는 ASCII 문자열로만 구성함으로써 위와 같은 이슈를 해결할 수 있습니다.

우리가 자주 사용하는 메일의 MIME(Multipurpose Internet Mail Extensions) 표준에서도 content transfer encoding 중 하나로 정의 되어 사용되고 있습니다. 부수적으로 XML이나 HTTP프로토콜에서도 특수문자 파싱 문제를 해결할 수 있는 수단중 하나로도 사용됩니다.만약 바이너리 데이터를 Stream을 통해 직접 안전하게 주고 받을 수 있는 환경이라면 굳이 오버헤드를 발생시키면서 사용할 필요는 없습니다.

Base64는 어떤 문자와 기호를 쓰느냐에 따라 다양한 변종이 있지만, 대부분 처음 62개는 알파벳 A-Z, a-z와 0-9를 사용하며 마지막 두 개를 어떤 기호를 쓰느냐의 차이만 있습니다.

## base64인코딩 과정
변경하는 방식을 간략하게 설명하면 Binary Data를 6bit 씩 자른 뒤 6bit에 해당하는 문자를 아래 Base64 색인표에서 찾아 치환합니다. 비트가 맞아 떨어지지 않는 경우 실제로는 Padding을 더해주는 과정이 추가됩니다. Base64 Encoding을 하게되면 전송해야 될 데이터의 양도 약 33% 정도 늘어납니다. 6bit당 2bit의 Overhead가 발생하기 때문입니다. Encoding전 대비 33%나 데이터의 크기가 증가하고, Encoding과 Decoding에 추가 CPU 연산까지 필요한데 우리는 왜 Base64 Encoding을 할까요?


## 결론
문자를 전송하기 위해 설계된 Media(Email, HTML)를 이용해 플랫폼 독립적으로 Binary Data(이미지나 오디오)를 전송 할 필요가 있을 때, ASCII로 Encoding하여 전송하게 되면 여러가지 문제가 발생할 수 있습니다. 대표적인 문제는 ASCII는 7 bits Encoding인데 나머지 1bit를 처리하는 방식이 시스템 별로 상이합니다. 일부 제어문자 (e.g. Line ending)의 경우 시스템 별로 다른 코드값을 갖습니다. 따라서 `ASCII는 시스템간 데이터를 전달하기에 안전하지가 않습니다.` Base64는 ASCII 중 제어문자와 일부 특수문자를 제외한 64개의 안전한 출력 문자만 사용합니다. 이때 안전한 출력 문자는 문자 코드에 영향을 받지 않는 공통 ASCII를 의미합니다.

즉, Base64는 HTML 또는 Email과 같이 문자를 위한 Media에 Binary Data를 포함해야 될 필요가 있을 때, 포함된 Binary Data가 시스템 독립적으로 동일하게 전송 또는 저장되는걸 보장하기 위해 사용한다. 라고 정리 할 수 있습니다.


----
해당 내용은 다음 글을 참고 하였습니다.
- https://ko.wikipedia.org/wiki/%EB%B2%A0%EC%9D%B4%EC%8A%A464
- https://ifuwanna.tistory.com/72
- https://effectivesquid.tistory.com/entry/Base64-%EC%9D%B8%EC%BD%94%EB%94%A9%EC%9D%B4%EB%9E%80